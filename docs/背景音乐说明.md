# 🎵 背景音乐系统说明

## 音乐文件配置

你的游戏现在使用两个背景音乐：

### 🎶 普通波次音乐
- **文件**: `sounds/L.S.传送带.mp3` (4.9MB)
- **使用场景**: 第1-5波（非BOSS波次）
- **音量**: 30%（可调节）

### 🎸 BOSS波次音乐  
- **文件**: `sounds/Brainiac.mp3` (8.2MB)
- **使用场景**: 第6-7波（BOSS波次）
- **音量**: 40%（可调节）

## 自动切换逻辑

游戏会根据以下条件自动判断是否为BOSS波次：

### 🔍 BOSS波次判断条件（满足任一即可）：
1. **生成模式**: `spawnMode: "boss"`
2. **特殊标记**: `specialEffects.bossWave: true`  
3. **包含BOSS怪物**: 怪物列表中有 `type: 'boss'`

### 📋 当前波次配置：
- **第1-5波**: 普通波次 → 播放"L.S.传送带"
- **第6波**: Boss模式 → 播放"Brainiac"
- **第7波**: Boss模式，包含BOSS怪物 → 播放"Brainiac"

## 🎮 游戏中的控制

### 音量控制
- **主音量**: 控制整体音量
- **音效音量**: 控制游戏音效
- **音乐音量**: 控制背景音乐

### 背景音乐控制
- **🎵 播放音乐**: 手动播放普通背景音乐
- **🔄 切换音乐**: 手动在普通音乐和BOSS音乐间切换
- **音乐状态显示**: 实时显示当前播放的音乐和状态

## 🔧 技术特性

### 自动特性
- ✅ 游戏启动1秒后自动播放背景音乐
- ✅ 波次开始时自动切换相应音乐
- ✅ 无缝循环播放
- ✅ 音乐状态实时更新

### 音效管理
- **智能切换**: 只有在需要时才切换音乐，避免重复播放
- **状态追踪**: 记录当前播放的音乐类型
- **音量调节**: 独立的音乐音量控制
- **错误处理**: 如果音频文件加载失败会有日志提示

## 🎯 使用体验

### 游戏中的音乐体验：
1. **进入游戏**: 自动播放轻快的"L.S.传送带"
2. **普通波次**: 继续播放普通音乐，营造轻松氛围
3. **BOSS波次**: 自动切换到紧张的"Brainiac"，增强压迫感
4. **手动控制**: 可以随时通过按钮切换或调节音量

### 调试信息：
游戏控制台会显示：
- `🎵 检测到BOSS波次，切换到BOSS背景音乐`
- `🎵 普通波次，切换到普通背景音乐`
- `🎵 音乐已经是BOSS模式，无需切换`

## 📝 自定义说明

如果你想修改音乐配置：

### 更换音乐文件：
1. 将新的MP3文件放入 `sounds` 目录
2. 修改 `audio-manager.js` 中的文件路径：
```javascript
music: {
    'normal_background': { file: 'sounds/你的普通音乐.mp3', volume: 0.3, loop: true },
    'boss_background': { file: 'sounds/你的BOSS音乐.mp3', volume: 0.4, loop: true }
}
```

### 调整触发条件：
修改 `spawner.js` 中的 `isBossWave()` 方法来改变BOSS音乐的触发条件。

### 调整音量：
在音效配置中修改 `volume` 值（0.0-1.0范围）。

## 🎊 完成状态

✅ 背景音乐系统已完全集成
✅ 自动切换功能已实现
✅ 手动控制界面已添加
✅ 音量控制已配置
✅ 状态显示已完成

现在你的塔防游戏拥有了完整的背景音乐系统！🎮🎵 